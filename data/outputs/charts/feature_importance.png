import pandas as pd
import matplotlib.pyplot as plt
from sklearn.ensemble import RandomForestClassifier

# Load data
data = pd.read_csv("../data/inputs/raw_data.csv")
X = data.drop(columns=["target"])
y = data["target"]

# Train a Random Forest model to get feature importances
model = RandomForestClassifier(n_estimators=100, random_state=42)
model.fit(X, y)

# Get feature importances
importances = model.feature_importances_
features = X.columns

# Create a DataFrame for feature importances
importance_df = pd.DataFrame({
    "Feature": features,
    "Importance": importances
}).sort_values(by="Importance", ascending=False)

# Plot feature importances
plt.figure(figsize=(8, 6))
plt.bar(importance_df["Feature"], importance_df["Importance"], color="skyblue")
plt.title("Feature Importance Scores")
plt.xlabel("Features")
plt.ylabel("Importance")
plt.xticks(rotation=45)
plt.tight_layout()
plt.savefig("../data/outputs/charts/feature_importance.png")
plt.show()
